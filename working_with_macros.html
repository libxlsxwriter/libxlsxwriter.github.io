<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libxlsxwriter: Working with VBA Macros</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libxlsxwriter
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Working with VBA Macros </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ww_macros_xlsm_format">The Excel XLSM file format</a></li>
<li class="level1"><a href="#ww_macros_include">How VBA macros are included in libxlsxwriter files</a></li>
<li class="level1"><a href="#ww_macros_extract">The vba_extract.py utility</a></li>
<li class="level1"><a href="#ww_macros_adding">Adding the VBA macros to a libxlsxwriter file</a></li>
<li class="level1"><a href="#ww_macros_codenames">Setting the VBA codenames</a></li>
<li class="level1"><a href="#ww_macros_signature">Adding signed VBA macros to a libxlsxwriter file</a></li>
<li class="level1"><a href="#ww_macros_debugging">What to do if it doesn&#39;t work</a></li>
</ul>
</div>
<div class="textblock"><p>This section explains how to add a VBA file containing functions or macros to an libxlsxwriter workbook.</p>
 <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;xlsxwriter.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Note the xlsm extension of the filename */</span></div>
<div class="line">    <a class="code hl_struct" href="structlxw__workbook.html">lxw_workbook</a>  *workbook  = <a class="code hl_function" href="workbook_8h.html#a89d256eddbfc5bbac0925e0d38b8139c">workbook_new</a>(<span class="stringliteral">&quot;macro.xlsm&quot;</span>);</div>
<div class="line">    <a class="code hl_struct" href="structlxw__worksheet.html">lxw_worksheet</a> *worksheet = <a class="code hl_function" href="workbook_8h.html#add5f5793676a87cf9173f52da9cb04f5">workbook_add_worksheet</a>(workbook, NULL);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="worksheet_8h.html#a9656e4e05d3787eee6b3e4d8e82d9b7f">worksheet_set_column</a>(worksheet, <a class="code hl_define" href="utility_8h.html#a189672bfa9c380a28d8db8c40de17fe8">COLS</a>(<span class="stringliteral">&quot;A:A&quot;</span>), 30, NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add a macro file extracted from an Excel workbook. */</span></div>
<div class="line">    <a class="code hl_function" href="workbook_8h.html#a8de478eed94be65de0622c64a0179ff9">workbook_add_vba_project</a>(workbook, <span class="stringliteral">&quot;vbaProject.bin&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="worksheet_8h.html#ac208046e7a6d12cc87982422efa41b31">worksheet_write_string</a>(worksheet, 2, 0, <span class="stringliteral">&quot;Press the button to say hello.&quot;</span>, NULL);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="structlxw__button__options.html">lxw_button_options</a> options = {.<a class="code hl_variable" href="structlxw__button__options.html#a83e56bf2c86bcec3cc58e96dc44a2dbd">caption</a> = <span class="stringliteral">&quot;Press Me&quot;</span>, .macro = <span class="stringliteral">&quot;say_hello&quot;</span>,</div>
<div class="line">                                  .width = 80, .height = 30};</div>
<div class="line"> </div>
<div class="line">     <a class="code hl_function" href="worksheet_8h.html#a0d4e20a797b8a3df10a7592a4278d024">worksheet_insert_button</a>(worksheet, 2, 1, &amp;options);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="workbook_8h.html#ad9e7aeebc0fd43562db5bcd527b2ee5e">workbook_close</a>(workbook);</div>
<div class="ttc" id="astructlxw__button__options_html"><div class="ttname"><a href="structlxw__button__options.html">lxw_button_options</a></div><div class="ttdoc">Options for inserted buttons.</div><div class="ttdef"><b>Definition:</b> worksheet.h:1901</div></div>
<div class="ttc" id="astructlxw__button__options_html_a83e56bf2c86bcec3cc58e96dc44a2dbd"><div class="ttname"><a href="structlxw__button__options.html#a83e56bf2c86bcec3cc58e96dc44a2dbd">lxw_button_options::caption</a></div><div class="ttdeci">const char * caption</div><div class="ttdef"><b>Definition:</b> worksheet.h:1906</div></div>
<div class="ttc" id="astructlxw__workbook_html"><div class="ttname"><a href="structlxw__workbook.html">lxw_workbook</a></div><div class="ttdoc">Struct to represent an Excel workbook.</div><div class="ttdef"><b>Definition:</b> workbook.h:293</div></div>
<div class="ttc" id="astructlxw__worksheet_html"><div class="ttname"><a href="structlxw__worksheet.html">lxw_worksheet</a></div><div class="ttdoc">Struct to represent an Excel worksheet.</div><div class="ttdef"><b>Definition:</b> worksheet.h:2108</div></div>
<div class="ttc" id="autility_8h_html_a189672bfa9c380a28d8db8c40de17fe8"><div class="ttname"><a href="utility_8h.html#a189672bfa9c380a28d8db8c40de17fe8">COLS</a></div><div class="ttdeci">#define COLS(cols)</div><div class="ttdoc">Convert an Excel A:B column range into a (col1, col2) pair.</div><div class="ttdef"><b>Definition:</b> utility.h:64</div></div>
<div class="ttc" id="aworkbook_8h_html_a89d256eddbfc5bbac0925e0d38b8139c"><div class="ttname"><a href="workbook_8h.html#a89d256eddbfc5bbac0925e0d38b8139c">workbook_new</a></div><div class="ttdeci">lxw_workbook * workbook_new(const char *filename)</div><div class="ttdoc">Create a new workbook object.</div></div>
<div class="ttc" id="aworkbook_8h_html_a8de478eed94be65de0622c64a0179ff9"><div class="ttname"><a href="workbook_8h.html#a8de478eed94be65de0622c64a0179ff9">workbook_add_vba_project</a></div><div class="ttdeci">lxw_error workbook_add_vba_project(lxw_workbook *workbook, const char *filename)</div><div class="ttdoc">Add a vbaProject binary to the Excel workbook.</div></div>
<div class="ttc" id="aworkbook_8h_html_ad9e7aeebc0fd43562db5bcd527b2ee5e"><div class="ttname"><a href="workbook_8h.html#ad9e7aeebc0fd43562db5bcd527b2ee5e">workbook_close</a></div><div class="ttdeci">lxw_error workbook_close(lxw_workbook *workbook)</div><div class="ttdoc">Close the Workbook object and write the XLSX file.</div></div>
<div class="ttc" id="aworkbook_8h_html_add5f5793676a87cf9173f52da9cb04f5"><div class="ttname"><a href="workbook_8h.html#add5f5793676a87cf9173f52da9cb04f5">workbook_add_worksheet</a></div><div class="ttdeci">lxw_worksheet * workbook_add_worksheet(lxw_workbook *workbook, const char *sheetname)</div><div class="ttdoc">Add a new worksheet to a workbook.</div></div>
<div class="ttc" id="aworksheet_8h_html_a0d4e20a797b8a3df10a7592a4278d024"><div class="ttname"><a href="worksheet_8h.html#a0d4e20a797b8a3df10a7592a4278d024">worksheet_insert_button</a></div><div class="ttdeci">lxw_error worksheet_insert_button(lxw_worksheet *worksheet, lxw_row_t row, lxw_col_t col, lxw_button_options *options)</div><div class="ttdoc">Insert a button object into a worksheet.</div></div>
<div class="ttc" id="aworksheet_8h_html_a9656e4e05d3787eee6b3e4d8e82d9b7f"><div class="ttname"><a href="worksheet_8h.html#a9656e4e05d3787eee6b3e4d8e82d9b7f">worksheet_set_column</a></div><div class="ttdeci">lxw_error worksheet_set_column(lxw_worksheet *worksheet, lxw_col_t first_col, lxw_col_t last_col, double width, lxw_format *format)</div><div class="ttdoc">Set the properties for one or more columns of cells.</div></div>
<div class="ttc" id="aworksheet_8h_html_ac208046e7a6d12cc87982422efa41b31"><div class="ttname"><a href="worksheet_8h.html#ac208046e7a6d12cc87982422efa41b31">worksheet_write_string</a></div><div class="ttdeci">lxw_error worksheet_write_string(lxw_worksheet *worksheet, lxw_row_t row, lxw_col_t col, const char *string, lxw_format *format)</div><div class="ttdoc">Write a string to a worksheet cell.</div></div>
<div class="line">}</div>
</div><!-- fragment --><div class="image">
<img src="macros.png" alt=""/>
</div>
<h1><a class="anchor" id="ww_macros_xlsm_format"></a>
The Excel XLSM file format</h1>
<p>An Excel <code>xlsm</code> file is exactly the same as an <code>xlsx</code> file except that is contains an additional <code>vbaProject.bin</code> file which contains functions and/or macros. Excel uses a different extension to differentiate between the two file formats since files containing macros are usually subject to additional security checks.</p>
<h1><a class="anchor" id="ww_macros_include"></a>
How VBA macros are included in libxlsxwriter files</h1>
<p>The <code>vbaProject.bin</code> file is a binary OLE COM container. This was the format used in older <code>xls</code> versions of Excel prior to Excel 2007. Unlike all of the other components of an xlsx/xlsm file the data isn't stored in XML format. Instead the functions and macros as stored as a pre-parsed binary format. As such it wouldn't be feasible to define macros and create a <code>vbaProject.bin</code> file from scratch (at least not in the remaining lifespan and interest levels of the author).</p>
<p>Instead a workaround is used to extract <code>vbaProject.bin</code> files from existing xlsm files and then add these to libxlsxwriter generated files.</p>
<h1><a class="anchor" id="ww_macros_extract"></a>
The vba_extract.py utility</h1>
<p>The <code>vba_extract.py</code> Python utility is used to extract the <code>vbaProject.bin</code> binary from an Excel 2007+ xlsm file. The utility is included in the libxlsxwriter examples directory: </p><pre class="fragment">$ python examples/vba_extract.py macro_file.xlsm
Extracted: vbaProject.bin
</pre><p> You can also install <code>vba_extract.py</code> into your system path by installing the Python xlsxwriter module: </p><pre class="fragment">$ pip install xlsxwriter
...
$ vba_extract.py
Utility to extract a vbaProject.bin binary from an
Excel 2007+ xlsm macro file ...
</pre><p> If the VBA project is signed, <code>vba_extract.py</code> also extracts the <code>vbaProjectSignature.bin</code> file from the xlsm file. For adding a VBA project signature see <a class="el" href="working_with_macros.html#ww_macros_signature">Adding signed VBA macros to a libxlsxwriter file</a>.</p>
<h1><a class="anchor" id="ww_macros_adding"></a>
Adding the VBA macros to a libxlsxwriter file</h1>
<p>Once the <code>vbaProject.bin</code> file has been extracted it can be added to the libxlsxwriter workbook using the <code><a class="el" href="workbook_8h.html#a8de478eed94be65de0622c64a0179ff9" title="Add a vbaProject binary to the Excel workbook.">workbook_add_vba_project()</a></code> function:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="workbook_8h.html#a8de478eed94be65de0622c64a0179ff9">workbook_add_vba_project</a>(workbook, <span class="stringliteral">&quot;./vbaProject.bin&quot;</span>);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The name doesn't have to be <code>vbaProject.bin</code>. Any suitable path/name for an existing VBA bin file will do.</dd></dl>
<p>If the VBA file contains functions you can then refer to them in calculations using <code><a class="el" href="worksheet_8h.html#ae57117f04c82bef29805ec3eabc219bb" title="Write a formula to a worksheet cell.">worksheet_write_formula()</a></code>:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="worksheet_8h.html#ae57117f04c82bef29805ec3eabc219bb">worksheet_write_formula</a>(0, 0, <span class="stringliteral">&quot;=MyMortgageCalc(200000, 25)&quot;</span>)</div>
<div class="ttc" id="aworksheet_8h_html_ae57117f04c82bef29805ec3eabc219bb"><div class="ttname"><a href="worksheet_8h.html#ae57117f04c82bef29805ec3eabc219bb">worksheet_write_formula</a></div><div class="ttdeci">lxw_error worksheet_write_formula(lxw_worksheet *worksheet, lxw_row_t row, lxw_col_t col, const char *formula, lxw_format *format)</div><div class="ttdoc">Write a formula to a worksheet cell.</div></div>
</div><!-- fragment --><p>Excel files that contain functions and macros should use an <code>xlsm</code> extension or else Excel will complain and possibly not open the file:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structlxw__workbook.html">lxw_workbook</a> *workbook = new_workbook(<span class="stringliteral">&quot;macro.xlsm&quot;</span>);</div>
</div><!-- fragment --><p>It is also possible to assign a macro to a button that is inserted into a worksheet using the <code><a class="el" href="worksheet_8h.html#a0d4e20a797b8a3df10a7592a4278d024" title="Insert a button object into a worksheet.">worksheet_insert_button()</a></code> function:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structlxw__button__options.html">lxw_button_options</a> options = {.<a class="code hl_variable" href="structlxw__button__options.html#a83e56bf2c86bcec3cc58e96dc44a2dbd">caption</a> = <span class="stringliteral">&quot;Press Me&quot;</span>,</div>
<div class="line">                              .macro   = <span class="stringliteral">&quot;say_hello&quot;</span>};</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_function" href="worksheet_8h.html#a0d4e20a797b8a3df10a7592a4278d024">worksheet_insert_button</a>(worksheet, 2, 1, &amp;options);</div>
</div><!-- fragment --><p>See the full example at <a class="el" href="macro_8c-example.html">macro.c</a>.</p>
<p>It may be necessary to specify a more explicit macro name prefixed by the workbook VBA name as follows:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structlxw__button__options.html">lxw_button_options</a> options = {.<a class="code hl_variable" href="structlxw__button__options.html#a83e56bf2c86bcec3cc58e96dc44a2dbd">caption</a> = <span class="stringliteral">&quot;Press Me&quot;</span>,</div>
<div class="line">                              .macro   = <span class="stringliteral">&quot;ThisWorkbook.say_hello&quot;</span>};</div>
<div class="line"> </div>
<div class="line"> <a class="code hl_function" href="worksheet_8h.html#a0d4e20a797b8a3df10a7592a4278d024">worksheet_insert_button</a>(worksheet, 2, 1, &amp;options);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Button is the only VBA Control supported by libxlsxwriter and due to the implementation effort required it is unlikely that any other form elements will be added in the future.</dd></dl>
<h1><a class="anchor" id="ww_macros_codenames"></a>
Setting the VBA codenames</h1>
<p>VBA macros generally refer to workbook and worksheet objects. If the VBA codenames aren't specified explicitly then libxlsxwriter will use the Excel defaults of <code>ThisWorkbook</code> and <code>Sheet1</code>, <code>Sheet2</code> etc.</p>
<p>If the macro uses other codenames you can set them using the <code><a class="el" href="workbook_8h.html#a24dd6624ffdc3e17aa5bcfb4608755b8" title="Set the VBA name for the workbook.">workbook_set_vba_name()</a></code> and <code><a class="el" href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b" title="Set the VBA name for the worksheet.">worksheet_set_vba_name()</a></code> functions as follows:</p>
<div class="fragment"><div class="line"><span class="comment">// Set the VBA codenames for the workbook and any worksheets.</span></div>
<div class="line"><a class="code hl_function" href="workbook_8h.html#a24dd6624ffdc3e17aa5bcfb4608755b8">workbook_set_vba_name</a> (workbook,  <span class="stringliteral">&quot;MyWorkbook&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b">worksheet_set_vba_name</a>(worksheet, <span class="stringliteral">&quot;MySheet1&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b">worksheet_set_vba_name</a>(worksheet, <span class="stringliteral">&quot;MySheet2&quot;</span>);</div>
<div class="ttc" id="aworkbook_8h_html_a24dd6624ffdc3e17aa5bcfb4608755b8"><div class="ttname"><a href="workbook_8h.html#a24dd6624ffdc3e17aa5bcfb4608755b8">workbook_set_vba_name</a></div><div class="ttdeci">lxw_error workbook_set_vba_name(lxw_workbook *workbook, const char *name)</div><div class="ttdoc">Set the VBA name for the workbook.</div></div>
<div class="ttc" id="aworksheet_8h_html_a8df6c0ce82172dafdd3e81923978bd4b"><div class="ttname"><a href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b">worksheet_set_vba_name</a></div><div class="ttdeci">lxw_error worksheet_set_vba_name(lxw_worksheet *worksheet, const char *name)</div><div class="ttdoc">Set the VBA name for the worksheet.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This step is particularly important for macros created with non-English versions of Excel.</dd></dl>
<p>You can find the names that are used in the VBA editor or by unzipping the <code>xlsm</code> file and grepping the files. The following shows how to do that using <a href="http://xmlsoft.org/xmllint.html">libxml's xmllint</a> to format the XML for clarity: </p><pre class="fragment">$ unzip myfile.xlsm -d myfile
$ xmllint --format `find myfile -name "*.xml" | xargs` | grep "Pr.*codeName"

  &lt;workbookPr codeName="MyWorkbook" defaultThemeVersion="124226"/&gt;
  &lt;sheetPr codeName="MySheet1"/&gt;
</pre> <dl class="section note"><dt>Note</dt><dd>This step is particularly important for macros created with non-English versions of Excel.</dd></dl>
<h1><a class="anchor" id="ww_macros_signature"></a>
Adding signed VBA macros to a libxlsxwriter file</h1>
<p>VBA macros can be signed in Excel to allow for blocking execution of unsigned macros in certain environments, for example.</p>
<p>The <code>vba_extract.py utility</code> can be used to extract the <code>vbaProject.bin</code> and <code>vbaProjectSignature.bin</code> files from an existing xlsm file with signed macros.</p>
<p>To add these files to the libxlsxwriter workbook use the <code><a class="el" href="workbook_8h.html#a4e5f8642ee2b46ced2adade1c520432f" title="Add a vbaProject binary and a vbaProjectSignature binary to the Excel workbook.">workbook_add_signed_vba_project()</a></code> function:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="workbook_8h.html#a4e5f8642ee2b46ced2adade1c520432f">workbook_add_signed_vba_project</a>(workbook,</div>
<div class="line">                                <span class="stringliteral">&quot;./vbaProject.bin&quot;</span>, <span class="stringliteral">&quot;./vbaProjectSignature.bin&quot;</span>);</div>
<div class="ttc" id="aworkbook_8h_html_a4e5f8642ee2b46ced2adade1c520432f"><div class="ttname"><a href="workbook_8h.html#a4e5f8642ee2b46ced2adade1c520432f">workbook_add_signed_vba_project</a></div><div class="ttdeci">lxw_error workbook_add_signed_vba_project(lxw_workbook *workbook, const char *vba_project, const char *signature)</div><div class="ttdoc">Add a vbaProject binary and a vbaProjectSignature binary to the Excel workbook.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The names don't have to be <code>vbaProject.bin</code> and <code>vbaProjectSignature.bin</code>. Any suitable paths/names for existing VBA project or signature files will do.</dd></dl>
<h1><a class="anchor" id="ww_macros_debugging"></a>
What to do if it doesn't work</h1>
<p>The libxlsxwriter test suite contains several tests to ensure that this feature works and there is a working example as shown above. However, there is no guarantee that it will work in all cases. Some effort may be required and some knowledge of VBA will certainly help. If things don't work out here are some things to try:</p>
<ol type="1">
<li>Start with a simple macro file, ensure that it works and then add complexity.</li>
<li>Check the code names that macros use to refer to the workbook and worksheets (see the previous section above). In general VBA uses a code name of <code>ThisWorkbook</code> to refer to the current workbook and the sheet name (such as <code>Sheet1</code>) to refer to the worksheets. These are the defaults used by libxlsxwriter. If the macro uses other names, or the macro was extracted from an non-English language version of Excel, then you can specify the appropriate names using the <code><a class="el" href="workbook_8h.html#a24dd6624ffdc3e17aa5bcfb4608755b8" title="Set the VBA name for the workbook.">workbook_set_vba_name()</a></code> and <code><a class="el" href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b" title="Set the VBA name for the worksheet.">worksheet_set_vba_name()</a></code> functions: <div class="fragment"><div class="line"><span class="comment">// Set the VBA codenames for the workbook and any worksheets.</span></div>
<div class="line"><a class="code hl_function" href="workbook_8h.html#a24dd6624ffdc3e17aa5bcfb4608755b8">workbook_set_vba_name</a> (workbook,  <span class="stringliteral">&quot;MyWorkbook&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b">worksheet_set_vba_name</a>(worksheet, <span class="stringliteral">&quot;MySheet1&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="worksheet_8h.html#a8df6c0ce82172dafdd3e81923978bd4b">worksheet_set_vba_name</a>(worksheet, <span class="stringliteral">&quot;MySheet2&quot;</span>);</div>
</div><!-- fragment --></li>
<li>Try to extract the macros from an Excel 2007 file. The method should work with macros from later versions (it was also tested with Excel 2010 macros). However there may be features in the macro files of more recent version of Excel that aren't backward compatible.</li>
</ol>
<p>Next: <a class="el" href="examples.html">Example Programs</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.20-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Copyright 2014-2024 John McNamara.
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
