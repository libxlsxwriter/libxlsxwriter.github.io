<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>libxlsxwriter: worksheet.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libxlsxwriter
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Contents</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_9a5cb1f80a06fe707e78a539c1c1dae8.html">xlsxwriter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a>  </div>
  <div class="headertitle">
<div class="title">worksheet.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>The Worksheet object represents an Excel worksheet. It handles operations such as writing data to cells or formatting worksheet layout.</p>
<p>A Worksheet object isn’t created directly. Instead a worksheet is created by calling the <a class="el" href="workbook_8h.html#a81d456b4f65a464e78e4a0030ecc3c2e" title="Add a new worksheet to a workbook: ">workbook_add_worksheet()</a> method from a Workbook object:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;xlsxwriter.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structlxw__workbook.html">lxw_workbook</a>  *workbook  = <a class="code" href="workbook_8h.html#a4c34a495371c477c06f16a2a0007dea7">new_workbook</a>(<span class="stringliteral">&quot;filename.xlsx&quot;</span>);</div>
<div class="line">    <a class="code" href="structlxw__worksheet.html">lxw_worksheet</a> *worksheet = <a class="code" href="workbook_8h.html#a81d456b4f65a464e78e4a0030ecc3c2e">workbook_add_worksheet</a>(workbook, NULL);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="worksheet_8h.html#ab689b1cfd53d6d14e55b8c078e733ff3">worksheet_write_string</a>(worksheet, 0, 0, <span class="stringliteral">&quot;Hello Excel&quot;</span>, NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="workbook_8h.html#aff39de16411dae703c5574ece9cac09b">workbook_close</a>(workbook);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a68ac932149fc7657b5479f067182d317"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t worksheet_write_number </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a> *&#160;</td>
          <td class="paramname"><em>worksheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__format.html">lxw_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">worksheet</td><td>Pointer to the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> instance to be updated. </td></tr>
    <tr><td class="paramname">row</td><td>The zero indexed row number. </td></tr>
    <tr><td class="paramname">col</td><td>The zero indexed column number. </td></tr>
    <tr><td class="paramname">number</td><td>The number to write to the cell. </td></tr>
    <tr><td class="paramname">format</td><td>A pointer to a Format instance or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b" title="Error codes from worksheet_write*() functions. ">lxw_write_error</a> code.</dd></dl>
<p>The <code><a class="el" href="worksheet_8h.html#a68ac932149fc7657b5479f067182d317" title="Write a number to a worksheet cell. ">worksheet_write_number()</a></code> method writes numeric types to the cell specified by <code>row</code> and <code>column</code>:</p>
<div class="fragment"><div class="line"><a class="code" href="worksheet_8h.html#a68ac932149fc7657b5479f067182d317">worksheet_write_number</a>(worksheet, 0, 0, 123456, NULL);</div>
<div class="line"><a class="code" href="worksheet_8h.html#a68ac932149fc7657b5479f067182d317">worksheet_write_number</a>(worksheet, 1, 0, 2.3451, NULL);</div>
</div><!-- fragment --><div class="image">
<img src="write_number01.png" alt="write_number01.png"/>
</div>
<p>The native data type for all numbers in Excel is a IEEE-754 64-bit double-precision floating point, which is also the default type used by <code>worksheet_write_number</code>.</p>
<p>The <code>format</code> parameter is used to apply formatting to the cell. This parameter can be <code>NULL</code> to indicate no formatting or it can be a <a class="el" href="format_8h.html">Format</a> object.</p>
<div class="fragment"><div class="line"><a class="code" href="structlxw__format.html">lxw_format</a> *format = <a class="code" href="workbook_8h.html#a279a5d7075d09a3931aae9782afede33">workbook_add_format</a>(workbook);</div>
<div class="line"><a class="code" href="format_8h.html#af77bbd0003344cb16d455c7fb709e16c">format_set_num_format</a>(format, <span class="stringliteral">&quot;$#,##0.00&quot;</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="worksheet_8h.html#a68ac932149fc7657b5479f067182d317">worksheet_write_number</a>(worksheet, 0, 0, 1234.567, format);</div>
</div><!-- fragment --><div class="image">
<img src="write_number02.png" alt="write_number02.png"/>
</div>
 <dl><dt><b>Examples: </b></dt><dd><a class="el" href="anatomy_8c-example.html#a9">anatomy.c</a>, <a class="el" href="dates_and_times01_8c-example.html#a7">dates_and_times01.c</a>, <a class="el" href="demo_8c-example.html#a8">demo.c</a>, <a class="el" href="format_num_format_8c-example.html#a7">format_num_format.c</a>, <a class="el" href="hello_8c-example.html#a5">hello.c</a>, <a class="el" href="tutorial1_8c-example.html#a5">tutorial1.c</a>, <a class="el" href="tutorial2_8c-example.html#a9">tutorial2.c</a>, and <a class="el" href="tutorial3_8c-example.html#a12">tutorial3.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ab689b1cfd53d6d14e55b8c078e733ff3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t worksheet_write_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a> *&#160;</td>
          <td class="paramname"><em>worksheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__format.html">lxw_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">worksheet</td><td>Pointer to the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> instance to be updated. </td></tr>
    <tr><td class="paramname">row</td><td>The zero indexed row number. </td></tr>
    <tr><td class="paramname">col</td><td>The zero indexed column number. </td></tr>
    <tr><td class="paramname">string</td><td>String to write to cell. </td></tr>
    <tr><td class="paramname">format</td><td>A pointer to a Format instance or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b" title="Error codes from worksheet_write*() functions. ">lxw_write_error</a> code.</dd></dl>
<p>The <code>worksheet_write_string()</code> method writes a string to the cell specified by <code>row</code> and <code>column</code>:</p>
<div class="fragment"><div class="line"><a class="code" href="worksheet_8h.html#ab689b1cfd53d6d14e55b8c078e733ff3">worksheet_write_string</a>(worksheet, 0, 0, <span class="stringliteral">&quot;This phrase is English!&quot;</span>, NULL);</div>
</div><!-- fragment --><div class="image">
<img src="write_string01.png" alt="write_string01.png"/>
</div>
<p>The <code>format</code> parameter is used to apply formatting to the cell. This parameter can be <code>NULL</code> to indicate no formatting or it can be a <a class="el" href="format_8h.html">Format</a> object:</p>
<div class="fragment"><div class="line"><a class="code" href="structlxw__format.html">lxw_format</a> *format = <a class="code" href="workbook_8h.html#a279a5d7075d09a3931aae9782afede33">workbook_add_format</a>(workbook);</div>
<div class="line"><a class="code" href="format_8h.html#a85e1b0baf44b445b65894e48722aec14">format_set_bold</a>(format);</div>
<div class="line"></div>
<div class="line"><a class="code" href="worksheet_8h.html#ab689b1cfd53d6d14e55b8c078e733ff3">worksheet_write_string</a>(worksheet, 0, 0, <span class="stringliteral">&quot;This phrase is Bold!&quot;</span>, format);</div>
</div><!-- fragment --><div class="image">
<img src="write_string02.png" alt="write_string02.png"/>
</div>
<p>Unicode strings are supported in UTF-8 encoding. This generally requires that your source file is UTF-8 encoded or that the data has been read from a UTF-8 source:</p>
<div class="fragment"><div class="line"><a class="code" href="worksheet_8h.html#ab689b1cfd53d6d14e55b8c078e733ff3">worksheet_write_string</a>(worksheet, 0, 0, <span class="stringliteral">&quot;Это фраза на русском!&quot;</span>, NULL);</div>
</div><!-- fragment --><div class="image">
<img src="write_string03.png" alt="write_string03.png"/>
</div>
 <dl><dt><b>Examples: </b></dt><dd><a class="el" href="anatomy_8c-example.html#a8">anatomy.c</a>, <a class="el" href="dates_and_times03_8c-example.html#a8">dates_and_times03.c</a>, <a class="el" href="demo_8c-example.html#a7">demo.c</a>, <a class="el" href="format_font_8c-example.html#a8">format_font.c</a>, <a class="el" href="hello_8c-example.html#a4">hello.c</a>, <a class="el" href="tutorial1_8c-example.html#a4">tutorial1.c</a>, <a class="el" href="tutorial2_8c-example.html#a8">tutorial2.c</a>, <a class="el" href="tutorial3_8c-example.html#a10">tutorial3.c</a>, and <a class="el" href="utf8_8c-example.html#a4">utf8.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a4c1912e29c76ca143314ed4e6f94045e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t worksheet_write_formula </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a> *&#160;</td>
          <td class="paramname"><em>worksheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>formula</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__format.html">lxw_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">worksheet</td><td>Pointer to the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> instance to be updated. </td></tr>
    <tr><td class="paramname">row</td><td>The zero indexed row number. </td></tr>
    <tr><td class="paramname">col</td><td>The zero indexed column number. </td></tr>
    <tr><td class="paramname">formula</td><td>Formula string to write to cell. </td></tr>
    <tr><td class="paramname">format</td><td>A pointer to a Format instance or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b" title="Error codes from worksheet_write*() functions. ">lxw_write_error</a> code.</dd></dl>
<p>The <code>worksheet_write_formula()</code> method writes a formula or function to the cell specified by <code>row</code> and <code>column</code>:</p>
<div class="fragment"><div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 0, 0, <span class="stringliteral">&quot;=B3 + 6&quot;</span>,                    NULL);</div>
<div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 1, 0, <span class="stringliteral">&quot;=SIN(PI()/4)&quot;</span>,               NULL);</div>
<div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 2, 0, <span class="stringliteral">&quot;=SUM(A1:A2)&quot;</span>,                NULL);</div>
<div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 3, 0, <span class="stringliteral">&quot;=IF(A3&gt;1,\&quot;Yes\&quot;, \&quot;No\&quot;)&quot;</span>,  NULL);</div>
<div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 4, 0, <span class="stringliteral">&quot;=AVERAGE(1, 2, 3, 4)&quot;</span>,       NULL);</div>
<div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 5, 0, <span class="stringliteral">&quot;=DATEVALUE(\&quot;1-Jan-2013\&quot;)&quot;</span>, NULL);</div>
</div><!-- fragment --><div class="image">
<img src="write_formula01.png" alt="write_formula01.png"/>
</div>
<p>The <code>format</code> parameter is used to apply formatting to the cell. This parameter can be <code>NULL</code> to indicate no formatting or it can be a <a class="el" href="format_8h.html">Format</a> object.</p>
<p>Libxlsxwriter doesn't calculate the value of a formula and instead stores a default value of <code>0</code>. The correct formula result is displayed in Excel, as shown in the example above, since it recalculates the formulas when it loads the file. For cases where this is an issue see the <code><a class="el" href="worksheet_8h.html#afbe504aaaa7b96b7032701847f28e13d" title="Write a formula to a worksheet cell with a user defined result. ">worksheet_write_formula_num()</a></code> function and the discussion in that section.</p>
<p>Formulas must be written with the US style separator/range operator which is a comma (not semi-colon). Therefore a formula with multiple values should be written as follows:</p>
<div class="fragment"><div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 0, 0, <span class="stringliteral">&quot;=SUM(1, 2, 3)&quot;</span>, NULL); <span class="comment">// OK.</span></div>
<div class="line"><a class="code" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e">worksheet_write_formula</a>(worksheet, 1, 0, <span class="stringliteral">&quot;=SUM(1; 2; 3)&quot;</span>, NULL); <span class="comment">// NO. Error on load.</span></div>
</div><!-- fragment --> <dl><dt><b>Examples: </b></dt><dd><a class="el" href="tutorial1_8c-example.html#a6">tutorial1.c</a>, <a class="el" href="tutorial2_8c-example.html#a10">tutorial2.c</a>, and <a class="el" href="tutorial3_8c-example.html#a13">tutorial3.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="afbe504aaaa7b96b7032701847f28e13d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t worksheet_write_formula_num </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a> *&#160;</td>
          <td class="paramname"><em>worksheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>formula</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__format.html">lxw_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">worksheet</td><td>Pointer to the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> instance to be updated. </td></tr>
    <tr><td class="paramname">row</td><td>The zero indexed row number. </td></tr>
    <tr><td class="paramname">col</td><td>The zero indexed column number. </td></tr>
    <tr><td class="paramname">formula</td><td>Formula string to write to cell. </td></tr>
    <tr><td class="paramname">format</td><td>A pointer to a Format instance or NULL. </td></tr>
    <tr><td class="paramname">result</td><td>A user defined result for a formula.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b" title="Error codes from worksheet_write*() functions. ">lxw_write_error</a> code.</dd></dl>
<p>The <code>worksheet_write_formula_num()</code> method writes a formula or function to the cell specified by <code>row</code> and <code>column</code> with a user defined result:</p>
<div class="fragment"><div class="line"><span class="comment">// Required as a workaround only.</span></div>
<div class="line"><a class="code" href="worksheet_8h.html#afbe504aaaa7b96b7032701847f28e13d">worksheet_write_formula_num</a>(worksheet, 0, 0, <span class="stringliteral">&quot;=1 + 2&quot;</span>, NULL, 3);</div>
</div><!-- fragment --><p>Libxlsxwriter doesn't calculate the value of a formula and instead stores the value <code>0</code> as the formula result. It then sets a global flag in the XLSX file to say that all formulas and functions should be recalculated when the file is opened.</p>
<p>This is the method recommended in the Excel documentation and in general it works fine with spreadsheet applications.</p>
<p>However, applications that don't have a facility to calculate formulas, such as Excel Viewer, or some mobile applications will only display the <code>0</code> results.</p>
<p>If required, the <code>worksheet_write_formula_num()</code> function can be used to specify a formula and its result.</p>
<p>This function is rarely required and is only provided for compatibility with some third party applications. For most applications the <a class="el" href="worksheet_8h.html#a4c1912e29c76ca143314ed4e6f94045e" title="Write a formula to a worksheet cell. ">worksheet_write_formula()</a> function is the recommended way of writing formulas. </p>

</div>
</div>
<a class="anchor" id="a2a41c29cf82c523d636715ed8cb732d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t worksheet_write_datetime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a> *&#160;</td>
          <td class="paramname"><em>worksheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__datetime.html">lxw_datetime</a> *&#160;</td>
          <td class="paramname"><em>datetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__format.html">lxw_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">worksheet</td><td>Pointer to the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> instance to be updated. </td></tr>
    <tr><td class="paramname">row</td><td>The zero indexed row number. </td></tr>
    <tr><td class="paramname">col</td><td>The zero indexed column number. </td></tr>
    <tr><td class="paramname">datetime</td><td>The datetime to write to the cell. </td></tr>
    <tr><td class="paramname">format</td><td>A pointer to a Format instance or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b" title="Error codes from worksheet_write*() functions. ">lxw_write_error</a> code.</dd></dl>
<p>The <code><a class="el" href="worksheet_8h.html#a2a41c29cf82c523d636715ed8cb732d3" title="Write a date or time to a worksheet cell. ">worksheet_write_datetime()</a></code> method can be used to write a date or time to the cell specified by <code>row</code> and <code>column</code>:</p>
 <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;xlsxwriter.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* A datetime to display. */</span></div>
<div class="line">    <a class="code" href="structlxw__datetime.html">lxw_datetime</a> datetime = {2013, 2, 28, 12, 0, 0.0};</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Create a new workbook and add a worksheet. */</span></div>
<div class="line">    <a class="code" href="structlxw__workbook.html">lxw_workbook</a>  *workbook  = <a class="code" href="workbook_8h.html#a4c34a495371c477c06f16a2a0007dea7">new_workbook</a>(<span class="stringliteral">&quot;date_and_times02.xlsx&quot;</span>);</div>
<div class="line">    <a class="code" href="structlxw__worksheet.html">lxw_worksheet</a> *worksheet = <a class="code" href="workbook_8h.html#a81d456b4f65a464e78e4a0030ecc3c2e">workbook_add_worksheet</a>(workbook, NULL);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Add a format with date formatting. */</span></div>
<div class="line">    <a class="code" href="structlxw__format.html">lxw_format</a>    *format    = <a class="code" href="workbook_8h.html#a279a5d7075d09a3931aae9782afede33">workbook_add_format</a>(workbook);</div>
<div class="line">    <a class="code" href="format_8h.html#af77bbd0003344cb16d455c7fb709e16c">format_set_num_format</a>(format, <span class="stringliteral">&quot;mmm d yyyy hh:mm AM/PM&quot;</span>);</div>
<div class="line">    <a class="code" href="worksheet_8h.html#a2a41c29cf82c523d636715ed8cb732d3">worksheet_write_datetime</a>(worksheet, 1, 0, &amp;datetime, format);  <span class="comment">// Feb 28 2013 12:00 PM</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="workbook_8h.html#aff39de16411dae703c5574ece9cac09b">workbook_close</a>(workbook);</div>
<div class="line">}</div>
</div><!-- fragment --></p>
<p>The <code>format</code> parameter should be used to apply formatting to the cell using a <a class="el" href="format_8h.html">Format</a> object as shown above. Without a date format the datetime will appear as a number only.</p>
<p>See <a class="el" href="working_with_dates.html">Working with Dates and Times</a> for more information about handling dates and times in libxlsxwriter. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="dates_and_times02_8c-example.html#a8">dates_and_times02.c</a>, <a class="el" href="dates_and_times03_8c-example.html#a12">dates_and_times03.c</a>, and <a class="el" href="tutorial3_8c-example.html#a11">tutorial3.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a5be18bd2bcfc926a1982f8915cbdce65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t worksheet_write_blank </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a> *&#160;</td>
          <td class="paramname"><em>worksheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlxw__format.html">lxw_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">worksheet</td><td>Pointer to the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> instance to be updated. </td></tr>
    <tr><td class="paramname">row</td><td>The zero indexed row number. </td></tr>
    <tr><td class="paramname">col</td><td>The zero indexed column number. </td></tr>
    <tr><td class="paramname">format</td><td>A pointer to a Format instance or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b" title="Error codes from worksheet_write*() functions. ">lxw_write_error</a> code.</dd></dl>
<p>Write a blank cell specified by <code>row</code> and <code>column</code>:</p>
<div class="fragment"><div class="line"><a class="code" href="worksheet_8h.html#a5be18bd2bcfc926a1982f8915cbdce65">worksheet_write_blank</a>(worksheet, 1, 1, border_format);</div>
</div><!-- fragment --><p>This method is used to add formatting to a cell which doesn't contain a string or number value.</p>
<p>Excel differentiates between an "Empty" cell and a "Blank" cell. An Empty cell is a cell which doesn't contain data or formatting whilst a Blank cell doesn't contain data but does contain formatting. Excel stores Blank cells but ignores Empty cells.</p>
<p>As such, if you write an empty cell without formatting it is ignored. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a356e12f6f1c3f94b8de98dc99ef78b86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structlxw__worksheet.html">lxw_worksheet</a>  <a class="el" href="structlxw__worksheet.html">lxw_worksheet</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The members of the <a class="el" href="structlxw__worksheet.html" title="Struct to represent an Excel worksheet. ">lxw_worksheet</a> struct aren't modified directly. Instead the worksheet properties are set by calling the functions shown in <a class="el" href="worksheet_8h.html" title="Functions related to adding data and formatting to a worksheet. ">worksheet.h</a>. </p>

</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlxw__worksheet.html">lxw_worksheet</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct to represent an Excel worksheet.  <a href="structlxw__worksheet.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a356e12f6f1c3f94b8de98dc99ef78b86"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structlxw__worksheet.html">lxw_worksheet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="worksheet_8h.html#a356e12f6f1c3f94b8de98dc99ef78b86">lxw_worksheet</a></td></tr>
<tr class="memdesc:a356e12f6f1c3f94b8de98dc99ef78b86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct to represent an Excel worksheet.  <a href="#a356e12f6f1c3f94b8de98dc99ef78b86">More...</a><br /></td></tr>
<tr class="separator:a356e12f6f1c3f94b8de98dc99ef78b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad031ffc1d718178a7180e8d63ebbf81b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad031ffc1d718178a7180e8d63ebbf81b"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="worksheet_8h.html#ad031ffc1d718178a7180e8d63ebbf81b">lxw_write_error</a> </td></tr>
<tr class="memdesc:ad031ffc1d718178a7180e8d63ebbf81b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error codes from <code>worksheet_write*()</code> functions. <br /></td></tr>
<tr class="separator:ad031ffc1d718178a7180e8d63ebbf81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
